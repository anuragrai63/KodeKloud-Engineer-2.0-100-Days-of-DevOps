# Day 63: Deploy Iron Gallery App on Kubernetes

## Scenario

There is an iron gallery app that the Nautilus DevOps team was developing. They have recently customized the app and are going to deploy the same on the Kubernetes cluster. Below you can find more details:

- Create a `namespace` `iron-namespace-datacenter`.
- Create a `deployment` `iron-gallery-deployment-datacenter` for iron gallery under the same `namespace` you created.
   - Labels `run` should be `iron-gallery`.
   - `Replicas` count should be `1`.
   - Selector's matchLabels `run` should be `iron-gallery`.
   - Template labels `run` should be `iron-gallery` under metadata.
   - The container should be named as `iron-gallery-container-datacenter`, use `kodekloud/irongallery:2.0` image ( use exact image name / tag ).
   - Resources `limits` for `memory` should be `100Mi` and for `CPU` should be `50m`.
   - First `volumeMount` name should be `config`, its `mountPath` should be `/usr/share/nginx/html/data`.
   - Second `volumeMount` name should be `images`, its `mountPath` should be `/usr/share/nginx/html/uploads`.
   - First volume name should be `config` and give it `emptyDir` and second volume name should be `images`, also give it `emptyDir`.
  
  > **Note:** The `kubectl` utility on jump_host is configured to operate with the Kubernetes cluster.

---

## Task

- Create `Secret`.
- Consume `Secret` inside `pod`.


---

## Solution

### 1. Create the Secret from `ecommerce.txt`

```bash
kubectl create secret generic ecommerce --from-file=/opt/ecommerce.txt

```
---


### 2. Create the Pod `secret-xfusion` with Secret Volume Mount
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: secret-xfusion
spec:
  containers:
  - name: secret-container-xfusion
    image: fedora:latest
    command: ["/bin/sh", "-c", "sleep infinity"]
    volumeMounts:
    - name: ecommerce-secret
      mountPath: /opt/games
  volumes:
  - name: ecommerce-secret
    secret:
      secretName: ecommerce

```
---

### 3. Apply manifest.
```bash
kubectl apply -f secret-pod.yaml

```
---

## Result

- `Secret` Created from file and mounted inside pod as a `volume`. 
