# Day 10: Linux Bash Scripts

## Scenario

The production support team of xFusionCorp Industries is working on developing bash scripts to automate various day-to-day tasks. One such task is creating a script for taking website backups.  
Your goal is to create a bash script to back up a specific website directory, store the backup locally, and transfer it to the Nautilus Backup Server without requiring a password for the transfer.

---

## Tasks

a. **Create a zip archive** named `xfusioncorp_beta.zip` of the `/var/www/html/beta` directory.  
b. **Save the archive** in `/backup/` on **App Server 1**. This is a temporary storage location (cleared weekly).  
c. **Copy the archive** to the **Nautilus Backup Server** in the `/backup/` directory.  
d. **Ensure the script copies without asking for a password** (set up passwordless SSH), and that the respective server user (e.g., `tony` for App Server 1) can run the script.

---

## Solution

### 1. Log in to App Server 1

```bash
ssh tony@172.16.238.10
```

---

### 2. Prepare Script Directory

```bash
sudo mkdir -p /scripts
sudo chown tony:tony /scripts
```

---

### 3. Create the Backup Script

Create `/scripts/beta_backup.sh` with the following content:

```bash
#!/bin/bash

SOURCE_DIR="/var/www/html/beta"
ARCHIVE_NAME="xfusioncorp_beta.zip"
LOCAL_BACKUP="/backup"
REMOTE_BACKUP="/backup"
REMOTE_USER="clint"
REMOTE_HOST="172.16.238.16"

# Create zip archive
zip -r "${LOCAL_BACKUP}/${ARCHIVE_NAME}" "$SOURCE_DIR"

# Copy archive to Nautilus Backup Server
scp "${LOCAL_BACKUP}/${ARCHIVE_NAME}" "${REMOTE_USER}@${REMOTE_HOST}:${REMOTE_BACKUP}/"
```

Make the script executable:

```bash
chmod +x /scripts/beta_backup.sh
```

---

### 4. Set Up Passwordless SSH to Backup Server

Generate an SSH key (if not already present):

```bash
ssh-keygen -t rsa
```

Copy the public key to the Nautilus Backup Server (`clint@172.16.238.16`):

```bash
ssh-copy-id clint@172.16.238.16
```

---

### 5. Test the Script

```bash
/scripts/beta_backup.sh
```

---

## Explanation

- The script creates a zip archive of the website directory and stores it locally in `/backup/`.
- It then securely copies (via `scp`) the archive to the Nautilus Backup Server's `/backup/` directory.
- Passwordless SSH ensures the script can run non-interactively.

---

**Result:**  
A backup script exists on **App Server 1** which archives the website and transfers it to the backup server, all without needing manual password entry.
